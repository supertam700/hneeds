import{r as e}from"./router-CeqegR0t.js";import{s as E,G as y,a as x}from"./index-CTcQB10b.js";const w=(o=20)=>{const[i,u]=e.useState([]),[d,r]=e.useState(!0),[p,a]=e.useState(null),[l,t]=e.useState(!1),[f,c]=e.useState(null),g=async P=>{try{r(!0),a(null);const s=await E(y,{first:o,after:P}),h=s.products.edges.map(n=>({...n.node,images:n.node.images.edges.map(m=>m.node),variants:n.node.variants.edges.map(m=>m.node)}));u(P?n=>[...n,...h]:h),t(s.products.pageInfo.hasNextPage),c(s.products.pageInfo.endCursor)}catch(s){console.error("Failed to fetch products:",s),a(s instanceof Error?s.message:"Failed to fetch products")}finally{r(!1)}},S=()=>{l&&f&&!d&&g(f)};return e.useEffect(()=>{g()},[]),{products:i,loading:d,error:p,hasNextPage:l,loadMore:S,refetch:()=>g()}},D=o=>{const[i,u]=e.useState(null),[d,r]=e.useState(!0),[p,a]=e.useState(null);return e.useEffect(()=>{o&&(async()=>{try{r(!0),a(null);const t=await E(x,{handle:o});if(!t.product)throw new Error("Product not found");const f={...t.product,images:t.product.images.edges.map(c=>c.node),variants:t.product.variants.edges.map(c=>c.node)};u(f)}catch(t){console.error("Failed to fetch product:",t),a(t instanceof Error?t.message:"Failed to fetch product")}finally{r(!1)}})()},[o]),{product:i,loading:d,error:p}};export{D as a,w as u};
